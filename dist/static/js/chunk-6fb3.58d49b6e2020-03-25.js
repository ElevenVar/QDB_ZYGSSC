(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6fb3"],{"0PTH":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=l(e("omC7")),i=l(e("cLjf")),n=l(e("hDQ3")),o=l(e("bS4n")),r=e("8t5x");function l(t){return t&&t.__esModule?t:{default:t}}a.default={name:"processPlans",data:function(){return{infoModal:!1,infoModalData:{scOrderNo:"",customerName:"",proScAttr:"",productName:"",region:"",signDate:"",orderReceiveStart:""},searchData:"",phaseName:"",activeIndex:"1",currentSort:0,goRouter:"",tableData:[{id:"",processingCycle:"",sort:"1",taskName:"",taskDescription:""}],taskData:{id:"",stageName:"",sort:"",taskVos:[]},subData:{id:"",orderCycle:"",atypiaVoList:[]}}},computed:{IDS:function(){return sessionStorage.proccessPlanID}},methods:(0,o.default)({},(0,r.mapActions)(["ruoterJump"]),(0,r.mapActions)("receiveModule",["sub_programme","get_programme","get_info_details"]),{get_info:function(){var t=(0,n.default)(i.default.mark(function t(){var a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get_info_details({id:this.IDS});case 2:200==(a=t.sent).code?(this.infoModalData=a.data,this.infoModal=!0):this.$notify({message:a.message,type:"error",customClass:"dgg-tip-msg"});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getProgramme:function(){var t=(0,n.default)(i.default.mark(function t(){var a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.IDS){t.next=5;break}return t.next=3,this.get_programme({id:this.IDS});case 3:200==(a=t.sent).code?a.data&&a.data.atypiaVoList&&a.data.atypiaVoList.length&&(this.subData=a.data):this.$notify({message:a.message,type:"error",customClass:"dgg-tip-msg"});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),subProgramme:function(){var t=(0,n.default)(i.default.mark(function t(){var a,e,n,o,r;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=sessionStorage.processPlanRoute?sessionStorage.processPlanRoute.substring(sessionStorage.processPlanRoute.indexOf("/",2)+1):"transaction",""!=this.subData.orderCycle){t.next=4;break}return this.$notify({message:"请输入订单办理周期",type:"warning",customClass:"dgg-tip-msg"}),t.abrupt("return");case 4:if(0!=this.subData.atypiaVoList.length){t.next=7;break}return this.$notify({message:"请输入至少一个阶段信息",type:"warning",customClass:"dgg-tip-msg"}),t.abrupt("return");case 7:for(e=0,n=this.subData.atypiaVoList;e<n.length;e++)for(o in n[e])"sort"==o&&this.$set(n[e],o,e+1);return t.next=10,this.sub_programme((0,s.default)(this.subData));case 10:200===(r=t.sent).code?(this.$message.success("操作成功"),this.ruoterJump({name:a})):this.$notify({message:r.message,type:"error",customClass:"dgg-tip-msg"});case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),liClick:function(t,a){this.currentSort=a,this.taskData=JSON.parse((0,s.default)(t)),this.tableData=JSON.parse((0,s.default)(t.taskVos))},delet_programme:function(t,a){var e=this;this.$confirm("确定删除这条阶段信息？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.subData.atypiaVoList.splice(a,1),e.addPhaseName()}).catch(function(){})},addPhaseName:function(){this.taskData={},this.taskData={id:"",sort:"",stageName:"",taskVos:[]},this.tableData=[],this.tableData.push({id:"",processingCycle:"",sort:"1",taskName:"",taskDescription:""})},subTask:function(){if(""!=this.taskData.stageName){for(var t=0;t<this.tableData.length;t++){if(""==this.tableData[t].processingCycle)return void this.$message.warning("第"+(t+1)+"行的所需工作日不能为空，请输入!");if(""==this.tableData[t].taskName)return void this.$message.warning("第"+(t+1)+"行的任务名称不能为空，请输入!");if(""==this.tableData[t].taskDescription)return void this.$message.warning("第"+(t+1)+"行的任务说明不能为空，请输入!");this.tableData[t].sort=t+1}if(this.taskData.taskVos=this.tableData,""==this.taskData.id)this.taskData.id=this.subData.atypiaVoList.length+1,this.subData.atypiaVoList.push(this.taskData);else for(var a=0;a<this.subData.atypiaVoList.length;a++)this.subData.atypiaVoList[a].id==this.taskData.id&&this.$set(this.subData.atypiaVoList,a,this.taskData);this.addPhaseName()}else this.$message.warning("请输入阶段名称")},addTasks:function(){var t=this.tableData.length+1;this.tableData.push({id:"",processingCycle:"",sort:t,taskName:"",taskDescription:""})},moveUp:function(t,a){0!=t?this.setTableData(t,"up"):this.$message.warning("第一条数据，不能上移!")},moveDown:function(t,a){t!=this.tableData.length-1?this.setTableData(t,"down"):this.$message.warning("最后一条数据，不能下移!")},setTableData:function(t,a){for(var e=void 0,s=0,i=this.tableData;s<i.length;s++)t==s&&(e=i[s]);this.tableData.splice(t,1),"down"==a?this.tableData.splice(t+1,0,e):this.tableData.splice(t-1,0,e)},deletes:function(t,a){var e=this,s=this.tableData;if(1!=s.length||""!=s[0].processingCycle&&""!=s[0].taskName&&""!=s[0].taskDescription){if(0==t&&0!=this.subData.atypiaVoList.length)return void this.$notify({message:"必须保留一条任务!",type:"warning",customClass:"dgg-tip-msg"});this.$confirm("确定删除这条任务信息？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.tableData.splice(t,1)}).catch(function(){})}else this.tableData.splice(t,1)}}),mounted:function(){this.subData.id=sessionStorage.proccessPlanID,this.getProgramme()},created:function(){}}},GWjq:function(t,a,e){"use strict";e.r(a);var s=e("Qxd9"),i=e("z7H5");for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);e("TyeL");var o=e("ZrdR"),r=Object(o.a)(i.default,s.a,s.b,!1,null,null,null);r.options.__file="processPlan.vue",a.default=r.exports},Qxd9:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"processPlan"},[e("div",{staticClass:"plan-item-header padding"},[t._v("\n    提交流程方案\n  ")]),t._v(" "),e("div",{staticClass:"plan-item-header padding"},[e("div",{staticClass:"fl"},[t._v("\n      订单办理周期\n      "),e("dgg-input",{staticClass:"search",staticStyle:{width:"150px"},attrs:{maxlength:"4",placeholder:"请输入所需工作日"},on:{input:function(a){t.subData.orderCycle=t.subData.orderCycle.replace(/[^\d]/g,"")}},model:{value:t.subData.orderCycle,callback:function(a){t.$set(t.subData,"orderCycle",a)},expression:"subData.orderCycle"}})],1),t._v(" "),e("div",{staticClass:"fr"},[e("span",{staticStyle:{"font-size":"12px",color:"#1DC4C1","margin-right":"20px",cursor:"pointer"},on:{click:t.get_info}},[t._v("查看订单信息")]),t._v(" "),e("dgg-button",{staticClass:"receive-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.subProgramme}},[t._v("\n        提交方案\n      ")])],1)]),t._v(" "),e("div",{staticClass:"plan-item-content"},[e("div",{staticClass:"plan-item-content-left"},[e("ul",{staticClass:"ul-item"},t._l(t.subData.atypiaVoList,function(a,s){return e("li",{key:s,staticClass:"dgg-text-ellip",class:{active:t.currentSort==s},on:{click:function(e){return t.liClick(a,s)}}},[e("el-tooltip",{attrs:{effect:"dark",content:a.stageName,placement:"top-start"}},[e("span",{staticClass:"dgg-text-ellip",staticStyle:{display:"inline-block",width:"190px","vertical-align":"top"}},[t._v("\n              "+t._s(a.stageName)+"\n            ")])]),t._v(" "),e("i",{staticClass:"el-icon-delete",staticStyle:{position:"absolute",right:"6px",top:"12px","z-index":"10"},on:{click:function(e){return e.stopPropagation(),t.delet_programme(a,s)}}})],1)}),0),t._v(" "),e("dgg-button",{staticClass:"brabBill-button",staticStyle:{width:"calc(100% - 10px)",position:"absolute",bottom:"0"},attrs:{"dgg-icon":"detail_icon_plus"},on:{click:t.addPhaseName}},[t._v("添加阶段")])],1),t._v(" "),e("div",{staticClass:"plan-item-content-right"},[e("div",{staticClass:"plan-item-right-header"},[e("dgg-input",{staticClass:"search",staticStyle:{width:"150px"},attrs:{maxlength:"30",oninput:"this.value=this.value.replace(/[^\\a-\\z\\A-\\Z0-9\\u4E00-\\u9FA5]/g,'')",placeholder:"请输入阶段名称"},model:{value:t.taskData.stageName,callback:function(a){t.$set(t.taskData,"stageName",a)},expression:"taskData.stageName"}}),t._v(" "),e("dgg-button",{staticClass:"receive-button",staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"primary"},on:{click:t.subTask}},[t._v("\n          确认\n        ")])],1),t._v(" "),e("div",{staticClass:"plan-item-right-content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"show-header":!1}},[e("el-table-column",{attrs:{prop:"taskName",label:"任务名称",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{padding:"0 5px"}},[e("el-input",{staticClass:"mini-input",attrs:{placeholder:"任务名称",maxlength:"50",oninput:"this.value=this.value.replace(/[^\\a-\\z\\A-\\Z0-9\\u4E00-\\u9FA5]/g,'')"},model:{value:a.row.taskName,callback:function(e){t.$set(a.row,"taskName",e)},expression:"scope.row.taskName"}})],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"processingCycle",label:"所需工作日",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{padding:"0 5px"}},[e("el-input",{staticClass:"mini-input",attrs:{placeholder:"请输入所需工作日",maxlength:"4"},on:{input:function(t){a.row.processingCycle=a.row.processingCycle.replace(/[^\d]/g,"")}},model:{value:a.row.processingCycle,callback:function(e){t.$set(a.row,"processingCycle",e)},expression:"scope.row.processingCycle"}})],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"taskDescription",label:"任务说明",width:"310"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{padding:"0 5px"}},[e("el-input",{staticClass:"mini-input long-input",attrs:{type:"textarea",maxlength:"200",placeholder:"请输入任务说明"},model:{value:a.row.taskDescription,callback:function(e){t.$set(a.row,"taskDescription",e)},expression:"scope.row.taskDescription"}})],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"操作","text-align":"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"el-icon-s-fold",staticStyle:{"font-size":"20px",transform:"rotate(90deg)"},on:{click:function(e){return t.moveUp(a.$index,a.row)}}}),t._v(" "),e("i",{staticClass:"el-icon-s-fold",staticStyle:{"font-size":"20px",transform:"rotate(-90deg)"},on:{click:function(e){return t.moveDown(a.$index,a.row)}}}),t._v(" "),e("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"18px"},on:{click:function(e){return t.deletes(a.$index,a.row)}}})]}}])})],1),t._v(" "),e("dgg-button",{staticClass:"brabBill-button",staticStyle:{width:"calc(100% - 10px)","margin-top":"10px"},attrs:{"dgg-icon":"detail_icon_plus"},on:{click:t.addTasks}},[t._v("添加任务\n        ")])],1)])]),t._v(" "),e("el-dialog",{attrs:{visible:t.infoModal,title:"订单信息",width:"400px",model:t.infoModalData},on:{"update:visible":function(a){t.infoModal=a}}},[e("el-form",{staticClass:"info_form"},[e("el-form-item",{attrs:{label:"订单编号"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.scOrderNo,callback:function(a){t.$set(t.infoModalData,"scOrderNo",a)},expression:"infoModalData.scOrderNo"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"客户信息"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.customerName,callback:function(a){t.$set(t.infoModalData,"customerName",a)},expression:"infoModalData.customerName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"产品类型"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.proScAttr,callback:function(a){t.$set(t.infoModalData,"proScAttr",a)},expression:"infoModalData.proScAttr"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"服务类型"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.productName,callback:function(a){t.$set(t.infoModalData,"productName",a)},expression:"infoModalData.productName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"业务地区"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.region,callback:function(a){t.$set(t.infoModalData,"region",a)},expression:"infoModalData.region"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"订单下单时间"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.signDate,callback:function(a){t.$set(t.infoModalData,"signDate",a)},expression:"infoModalData.signDate"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"订单接收时间"}},[e("el-input",{attrs:{readonly:""},model:{value:t.infoModalData.orderReceiveStart,callback:function(a){t.$set(t.infoModalData,"orderReceiveStart",a)},expression:"infoModalData.orderReceiveStart"}})],1)],1)],1)],1)},i=[];e.d(a,"a",function(){return s}),e.d(a,"b",function(){return i})},TyeL:function(t,a,e){"use strict";var s=e("Y20m");e.n(s).a},Y20m:function(t,a,e){},z7H5:function(t,a,e){"use strict";e.r(a);var s=e("0PTH"),i=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);a.default=i.a}}]);